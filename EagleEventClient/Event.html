<!DOCTYPE HTML> 
<html>
<head>
<script src="scripts/jquery.min.js"></script>
<script src="scripts/kendo.all.min.js"></script>
<link rel="stylesheet" type="text/css" href="Styles/kendo.common.min.css">
<link rel="stylesheet" type="text/css" href="Styles/kendo.default.min.css">
<link rel="stylesheet" type="text/css" href="Styles/kendo.default.mobile.min.css">
<link rel="stylesheet" type="text/css" href="style.css">
<title>Event Maintenance</title>
<style>
input[type="text"] {
    font-size: 14px;
    float: right;
    width: 290px;
}
</style>
<script type="text/javascript">
function AddClicked()
{
	$("#addEvent").show();
	$("#updateEvent").hide();
	$("#removeEvent").hide();
}

function UpdateClicked()
{
	$("#addEvent").hide();
	$("#updateEvent").show();
	$("#removeEvent").hide();
}
function RemoveClicked()
{
	$("#addEvent").hide();
	$("#updateEvent").hide();
	$("#removeEvent").show();
}

function getEvents() {
	$.ajax({
	    url: "/EagleEventService/event/eventservice/events/",
	    type: 'GET',
	    datatype: 'json',
	    statusCode: {
	    200: function( response ) {
					var test = "";
	    		},
	    401:function( response ) {

	    		},
    	    405:function( response ) {

	  	    	}
	    },
	    
	    error: function(jqXHR, textStatus, errorThrown) {
  	        console.log("error " + textStatus);
  	        console.log("incoming Text " + jqXHR.responseText);}
	  });   	
}

var updateDataItem;

function updateSelect(e)
{
	if (e.item) {
		updateDataItem = this.dataItem(e.item);
		$('#updateEvent').val(updateDataItem.event);
	}
}

var removeDataItem;

function removeSelect(e)
{
	if (e.item) {
		removeDataItem = this.dataItem(e.item);
	}
}

function Refresh()
{
	var dropdownlist1 = $("#updateEventName").data("kendoDropDownList");
	dropdownlist1.refresh();	
	var dropdownlist2 = $("#removeEventName").data("kendoDropDownList");
	dropdownlist2.refresh();	
}


$(document).ready(function() {
	
	var dataSource = new kendo.data.DataSource({
		  transport: { 
		    read: { 
		      url: "/EagleEventService/event/eventservice/events/", 
		      dataType: "json"
		    }
		  }
		});
	
    $("#updateEventName").kendoDropDownList({
        dataTextField: "name",
        dataValueField: "eventId",
        select: updateSelect,
        cascade: function(e)
        {
        	var dropdownlist = $("#updateEventName").data("kendoDropDownList");

        	if(dropdownlist.selectedIndex != -1)
        		{
        	// get the dataItem corresponding to the selectedIndex.
        	updateDataItem = dropdownlist.dataItem();

        	$('#updateEventName').val(updateDataItem.event);
        		}
        },
       	dataSource: dataSource
    });
    
    $("#removeEventName").kendoDropDownList({
        dataTextField: "name",
        dataValueField: "eventId",
        select: removeSelect,
        cascade: function(e)
        {
        	var dropdownlist = $("#removeEventName").data("kendoDropDownList");

        	// get the dataItem corresponding to the selectedIndex.
        	removeDataItem = dropdownlist.dataItem();
        },
       	dataSource: dataSource
    });
   
    
	$("#eventAddInformation").submit(function (e){
		$.ajax({
		    url: "/EagleEventService/event/eventservice/events/",
		    type: 'POST',
		    datatype: 'json',
			contentType: "application/json",
			data: '{'+  
			'"email" : "'+$('#addCustomerEmail').val() +'",'+
			'"name" : "'+$('#addCustomerName').val() +'"'+
			"}",
		    statusCode: {
		    200: function( response ) {
		    			dataSource.read();
		    			Refresh();
		    			alert('Customer was successfully added.');
		    		},
		    401:function( response ) {
		    		//$('#page-message').html("You must Login first");
		    		},
	    	    405:function( response ) {
		  	    	//$('#page-message').html("Access to the page forbiden");
		  	    	}
		    },
		    
		    error: function(jqXHR, textStatus, errorThrown) {
	  	        console.log("error " + textStatus);
	  	        console.log("incoming Text " + jqXHR.responseText);}
		  }); 
		e.preventDefault();
	});
	
	$("#customerUpdateInformation").submit(function (e){
		$.ajax({
		    url: "/EagleEventService/event/eventservice/customer/" + updateDataItem.customerId,
		    type: 'PUT',
		    datatype: 'json',
			contentType: "application/json",
			data: '{'+  
			'"customer_id" :"'+ updateDataItem.customerId +'",'+
			'"email" : "'+ $('#updateCustomerEmail').val() +'",'+
			'"name" : "'+ updateDataItem.name +'"'+
			"}",
		    statusCode: {
		    200: function( response ) {
		    			dataSource.read();
		    			Refresh();
		    			alert('Customer was successfully updated.');
		    		},
		    401:function( response ) {
		    		//$('#page-message').html("You must Login first");
		    		},
	    	    405:function( response ) {
		  	    	//$('#page-message').html("Access to the page forbidden");
		  	    	}
		    },
		    
		    error: function(jqXHR, textStatus, errorThrown) {
	  	        console.log("error " + textStatus);
	  	        console.log("incoming Text " + jqXHR.responseText);}
		  }); 
		e.preventDefault();
	});
	
	$("#eventRemoveInformation").submit(function (e){
		$.ajax({
		    url: "/EagleEventService/event/eventservice/events/" + updateDataItem.eventId,
		    type: 'DELETE',
		    datatype: 'json',
			contentType: "application/json",
			data: '{'+  
			'"event_id" :"'+ removeDataItem.eventId +'",'+
			'"name" : "'+ removeDataItem.name +'",'+
			'"venue" : "'+ removeDataItem.venue +'"'+
			"}",
		    statusCode: {
		    200: function( response ) {
		    			dataSource.read();
		    			Refresh();
		    			alert('Customer was successfully removed.');
		    		},
		    401:function( response ) {
		    		//$('#page-message').html("You must Login first");
		    		},
	    	    405:function( response ) {
		  	    	//$('#page-message').html("Access to the page forbidden");
		  	    	}
		    },
		    
		    error: function(jqXHR, textStatus, errorThrown) {
	  	        console.log("error " + textStatus);
	  	        console.log("incoming Text " + jqXHR.responseText);}
		  }); 
		e.preventDefault();
	});
});
</script>
</head>
<body> 
<div>
<ul class="nav">
<img src="images/eagleEventPlanningLogo.png" alt="logo" height="100">
<li><a href="EagleHome.html">Home</a></li>
<li><a href="Company.html">Company</a></li>
<li><a href="Customer.html">Customer</a></li>
<li><a href="Event.html">Event</a></li>
<li><a href="Staff.html">Staff</a></li>
<li><a href="logout.html">Logout</a></li>
</ul>
</div>
<div id="userWelcome"> </div>
<h2>Event Maintenance</h2>
<div class = "block-center">
<div id="buttonArea" style="float: left;width: 250px;">
		   <input type="image" src="images/eagleAddEventButton.png" height="auto" width="200" name="reset" value="Reset" style="float: right;" onclick="AddClicked()"><br>
			<input type="image" src="images/eagleUpdateEventButton.png" height="auto" width="200" name="reset" value="Reset" style="float: right;" onclick="UpdateClicked()"> <br>
		   	<input type="image" src="images/eagleRemoveEventButton.png" height="auto" width="200" name="reset" value="Reset" style="float: right;" onclick="RemoveClicked()"> <br>
</div>
<div id="eventInformation" class="generalArea" style="height: 300px;">
<br>
<div id="addEvent" style="display:none;">
		<form id="eventAddInformation" method="post"> 
		   Event Name:
		   <input type="text" id="addEventName" >
		   <span id="eventNameErr" class="error">* </span>
		   <br><br>
		   Venue:
		   <input type="text" id="addVenueName">
		   <span id="venueNameErr" class="error">* </span>
		   <br><br>
		   Customer Name:
		   <input type="text" id="addCustomerName">
		   <span id="customerNameErr" class="error">*</span>
		   <br><br>
		   Max Guests:
		   <input type="number" id="addMaxGuests">
		   <span id="maxGuestsErr" class="error">*</span>
		   <br><br>
		   # of Tables:
		   <input type="number" id="addNumberOfTables">
		   <span id="numberOfTablesErr" class="error">*</span>
		   <br><br>
		   Guest List File:
		   <input type="file" id="addGuestListFile">
		   <span id="guestListFileErr" class="error">*</span>
		   <input type="image" src="images/eagleLoadButton.png" 
		   		height="auto" width="200" name="load" value="Load"> 
		   <br><br>
		   <div id="page-message" style="color: red"></div>
		   		   <input type="image" src="images/eagleGenerateSeatingButton.png" 
		   		height="auto" width="200" name="generateSeating" value="GenerateSeating"> 
		   <input type="image" src="images/eaglePrintGuestListButton.png" 
		   		height="auto" width="200" name="printGuests" value="PrintGuests"> 
		   <input type="image" src="images/eaglePrintPlaceCardsButton.png" 
		   		height="auto" width="200" name="printPlaceCards" value="PrintPlaceCards"> 
		   <input type="image" src="images/eagleResetButton.png" 
		   		height="auto" width="200" name="reset" value="Reset"> 
		   <input type="image" src="images/eagleSaveButton.png" 
		   		height="auto" width="200" name="save" value="Save"> 
		</form></div>
<div id="updateEvent" style="display:none;">
<form id="eventUpdateInformation" method="post"> 
		   Event Name:
		   <input id="updateEventName" >
		   <span id="eventNameErr" class="error">* </span>
		   <br><br>
		   Staff Name:
		   <input type="text" id="updateStaffName" >
		   <span id="staffNameErr" class="error">* </span>
		   <br><br>		   
		   Customer Name:
		   <input type="text" id="updateCustomerName">
		   <span id="customerNameErr" class="error">*</span>
		   <br><br>
		   Guest List File:
		   <input type="file" id="updateGuestListFile">
		   <span id="guestListFileErr" class="error">*</span>
		   <input type="image" src="images/eagleLoadButton.png" 
		   		height="auto" width="200" name="load" value="Load"> 
		   <br><br>
		   <a href="MaintainTables.html">Maintain Tables</a>
		   <a href="MaintainGuests.html">Maintain Guests</a>
		
		   <div id="page-message" style="color: red"></div>
		   
		   <input type="image" src="images/eagleRegenerateSeatingButton.png" 
		   		height="auto" width="200" name="regenerateSeating" value="RegenerateSeating"> 
		   <input type="image" src="images/eaglePrintGuestListButton.png" 
		   		height="auto" width="200" name="printGuests" value="PrintGuests"> 
		   <input type="image" src="images/eaglePrintPlaceCardsButton.png" 
		   		height="auto" width="200" name="printPlaceCards" value="PrintPlaceCards">
		   <br><br> 
		   <input type="image" src="images/eagleResetButton.png" 
		   		height="auto" width="200" name="reset" value="Reset"> 
		   <input type="image" src="images/eagleSaveButton.png" 
		   		height="auto" width="200" name="save" value="Save"> 
		</form></div>
<div id="removeEvent" style="display:none;">
<form id="eventRemoveInformation" method="post"> 
		  Event Name:
		   <input id="removeEventName" >
		   <span id="eventNameErr" class="error">* </span>
		   <br><br>
		
		   <div id="page-message" style="color: red"></div>

		   <input type="image" src="images/eagleRemoveEventButton.png" 
		   		height="auto" width="100" name="delete" value="Delete"> 

		</form></div></div>
</div>

</body>
</html>